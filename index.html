<!DOCTYPE html>
<html>
<head>
    <title>Waveform Visualizer</title>
    <style>
        canvas {
            display: block;
            margin: 20px auto;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <input type="file" id="fileInput" accept=".wav">
    <canvas id="waveformCanvas"></canvas>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const fileInput = document.getElementById('fileInput');
            const canvas = document.getElementById('waveformCanvas');
            const context = canvas.getContext('2d');
          
            fileInput.addEventListener('change', handleFile, false);
          
            function handleFile(event) {
                const file = event.target.files[0];
              
                if (file.type && file.type.includes('audio')) {
                    const reader = new FileReader();
                  
                    reader.onload = function (e) {
                        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                      
                        audioContext.decodeAudioData(e.target.result, function (buffer) {
                            drawWaveform(buffer);
                        });
                    };
                  
                    reader.readAsArrayBuffer(file);
                } else {
                    alert('Please choose an audio file.');    
                }
            }
          
            function drawWaveform(buffer) {
                const data = buffer.getChannelData(0);
                const width = canvas.width;
                const height = canvas.height;
                const step = Math.ceil(data.length / width);
                const amp = height / 2;
              
                context.clearRect(0, 0, width, height);
                context.beginPath();
                context.moveTo(0, amp);
              
                for (let i = 0; i < width; i++) {
                    let min = 1.0;
                    let max = -1.0;
                  
                    for (let j = 0; j < step; j++) {
                        const value = data[i * step + j];
                      
                        if (value < min) min = value;
                        if (value > max) max = value;
                    }
                  
                    context.lineTo(i, (1 + min) * amp);
                    context.lineTo(i, (1 + max) * amp);
                }
              
                context.lineTo(width, amp);
                context.stroke();
            }
        });
    </script>
</body>
</html>
